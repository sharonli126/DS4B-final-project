---
title: "data_cleaning"
author: "Sharon"
date: "2023-10-05"
output: html_document
---

Library
```{r}
library(tibble)
library(readr)
library(skimr)
library(dplyr)
library(janitor)
```

raw data
```{r}
raw_data <- read_delim("raw_data/anage_data.txt", delim = "\t", escape_double = FALSE, trim_ws = TRUE)

data <- clean_names(raw_data)
```


Filtering only the data I want to investigate and identify is there any weird data.
```{r}
mammalia <- data[data$class == "Mammalia",]

mammalia_subset <- mammalia[, c("hagrid", "kingdom", "phylum", "class", "order", "family", "genus", "species", "common_name", "gestation_incubation_days", "weaning_days", "adult_weight_g", "inter_litter_interbirth_interval", "maximum_longevity_yrs" )]

primates<- mammalia_subset[mammalia_subset$order == "Primates",]
rodentia <- mammalia_subset[mammalia_subset$order == "Rodentia",]
```

Checking number of NA in the data

```{r}
skim(primates)
```

```{r}
skim(rodentia)
```

Here we try to remove nonsense data 

Assuming all species from same genus have a similar feature, so they wont have a vary difference
```{r}
primates|>
group_by(genus) |>
  summarise(range_gid = max(gestation_incubation_days, na.rm = T) - min(gestation_incubation_days, na.rm = T), 
            mean_gid = mean (gestation_incubation_days, na.rm = T),
            range_wd = max(weaning_days, na.rm = T) - min(weaning_days, na.rm = T), 
            mean_wd = mean (weaning_days, na.rm = T),
            range_longevity = max(maximum_longevity_yrs, na.rm = T) - min(maximum_longevity_yrs, na.rm = T), 
            mean_longivity = mean (maximum_longevity_yrs, na.rm = T), 
            n = n()) |>
  filter(n > 1)
```

```{r}
primates|>
group_by(genus) |>
  summarise(range_interbirth = max(inter_litter_interbirth_interval, na.rm = T) - min(inter_litter_interbirth_interval, na.rm = T), 
            mean_interbirth = mean (inter_litter_interbirth_interval, na.rm = T),
            range_weight = max(adult_weight_g, na.rm = T) - min(adult_weight_g, na.rm = T), 
            mean_weight = mean (adult_weight_g, na.rm = T), n = n()) |>
  filter(n > 1)
```

```{r}
rodentia|>
group_by(genus) |>
  summarise(range_gid = max(gestation_incubation_days, na.rm = T) - min(gestation_incubation_days, na.rm = T), 
            mean_gid = mean (gestation_incubation_days, na.rm = T),
            range_wd = max(weaning_days, na.rm = T) - min(weaning_days, na.rm = T), 
            mean_wd = mean (weaning_days, na.rm = T),
            range_longevity = max(maximum_longevity_yrs, na.rm = T) - min(maximum_longevity_yrs, na.rm = T), 
            mean_longivity = mean (maximum_longevity_yrs, na.rm = T), 
            range_weight = max(adult_weight_g, na.rm = T) - min(adult_weight_g, na.rm = T), 
            mean_weight = mean (adult_weight_g, na.rm = T),
            range_interbirth = max(inter_litter_interbirth_interval, na.rm = T) - min(inter_litter_interbirth_interval, na.rm = T), 
            mean_interbirth = mean (inter_litter_interbirth_interval, na.rm = T), n = n()) |>
  filter(n > 1)
```




Find the HAGRID out

Question:
1. Should i filter the data i want here or it is just data cleaning here?
2. confusion of issue in github
3. some graph problem: weaning day --> rodentia (have smaller range) 
4. if i am only investigating correlation of some order in mammal, is it ok for me to say i chose those because they havee larger sample size
5. Some factors were found to be not signifigant in correlation with lifespan, it is againsting some paper