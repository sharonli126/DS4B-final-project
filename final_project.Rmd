---
title: "A title for your project"
author: "Your name and U number"
date: "Today's date"
output:  
    html_document:
        toc: true
        toc_depth: 4
        theme: cosmo
        number_sections: false
        toc_float: true
        highlight: pygments
        fig_width: 8
        fig_height: 4
---
# Word/figure count

Words: [The number of words in your document, calculated using the word_count() function at the end of this document]
Figures: [The number of figures in your document. You can just count these]

# Location on GitHub

https://github.com/sharonli126/DS4B-final-project 

# Data Description

[A brief (~100-200 words should be more than enough) description of the dataset, referencing any key publications that go with it]

# Questions/Aims

__How do life-history traits leads to difference of longevity in between the orders Primates and Rodentia?__

[A brief section which first states and then justifies the questions/aims of your EDA. Must provide evidence of independent research into what has been done before on these questions/aims. See above for examples.]

Why do some animals live only a few years, but some can live several years, or even over a hundred year? This has been one of the most interesting questions in Biology all the time. While animals varies in lifespan, the order of Mammalia, which we, humans belong to, particularly present a diverse of lifespan. For hamster or mouse, they only have around 4 years lifespan but for a gorilla, it can live up to around 60 years, or humans and whales can live even over 100 years old! 

Both Primates and Rodentia are order with a large family, but they have represent two very different life-history strategies.Primates tend to have longer lifespans, extended juvenile dependency periods, and fewer offspring, while most rodents reproduce quickly, have shorter lifespans, and produce more offspring in their lifetime.

Therefore, to understand deeper of how different factors correlate with lifespan in Mammalia, this study analyse a big database of aging and life history in over 4600 animal species from AnAge, aiming to find the correlation of possible aging related factors, including body weight, birth condition and metabolic rate.

# Raw data

[Explains how and where to get the exact raw data you got]
[Is reproducible by a person (required) and a machine (ideally)]






Library
```{r, include=F}
library(tidyverse)
```

## Data Tidy

Loading the data
```{r}
raw_data <- read_delim("raw_data/anage_data.txt", 
                   delim = "\t", 
                   escape_double = FALSE, 
                   trim_ws = TRUE)

data <- raw_data |>
  clean_names()
```

Checking the data
```{r}
str(data)
```

```{r}
skim(data)
```


```{r}
aves <- data[data$class == "Aves",]
aves |>
  summarise(n = n())
summary(aves)
```

```{r}
aves_subset <- subset(aves, data_quality != "low" & sample_size != c("small", "tiny"))
```


```{r}
mammalia <- data[data$class == "Mammalia",]
mammalia_subset <- subset(mammalia, data_quality != "low" & sample_size != c("small", "tiny"))
```

```{r}
carnivora <- mammalia_subset[mammalia_subset$order == "Carnivora",]
primates <- mammalia_subset[mammalia_subset$order == "Primates",]
rodentia <- mammalia_subset[mammalia_subset$order == "Rodentia",]
artiodactyla <- mammalia_subset[mammalia_subset$order == "Artiodactyla",]
chiroptera <- mammalia_subset[mammalia_subset$order == "Chiroptera",]

selected_order <- rbind(carnivora, primates, rodentia, artiodactyla)
```


```{r}
weight <- mammalia_subset |>
  filter(!is.na(adult_weight_g) & !is.na(maximum_longevity_yrs))
```

```{r}
mammalia_subset|>
  group_by(order) |>
  summarise(n = n())|>
  arrange(desc(n))
```


## Correlation
```{r}
ggplot(aves, aes(x = maximum_longevity_yrs)) +
  geom_histogram() +
  coord_cartesian(xlim = c(1, 80))
```

```{r}
ggplot(mammalia, aes(x =inter_litter_interbirth_interval , y = adult_weight_g)) +
  geom_point() + 
  geom_smooth()
```

```{r}
ggplot(aves, aes(x = adult_weight_g, y = maximum_longevity_yrs)) +
  geom_point() + 
  geom_smooth() +
  labs(y = "Max. Lifespan") +
  coord_cartesian(xlim = c(1, 20000))
```


```{r}
ggplot(selected_order, aes(x = weaning_days, y = maximum_longevity_yrs)) +
  geom_point() + 
  geom_smooth() +
  labs(y = "Max. Lifespan") +
  facet_wrap(~ order)
```

 +
  coord_cartesian(xlim = c(1,10000))

```{r}
ggplot(selected_order, aes(x = gestation_incubation_days , y = maximum_longevity_yrs)) +
  geom_point() + 
  geom_smooth() +
  labs(y = "Max. Lifespan", x = "Gestation Incubation Days") +
  facet_wrap(~ order)
```

```{r}
ggplot(selected_order, aes(x = metabolic_rate_w , y = maximum_longevity_yrs)) +
  geom_point() + 
  geom_smooth() +
  labs(y = "Max. Lifespan")
```

Trying to fit a linear model
```{r}
model <- lm(data = mammalia_clean,
            adult_weight_g ~  
              weaning_days +
              inter_litter_interbirth_interval + 
              gestation_incubation_days)

summary(model)
```

__mentioning the reason of variance, eg: sample size__



```{r}
model_car <- lm(data = mammalia_clean, 
            maximum_longevity_yrs ~ adult_weight_g +
              order +
              gestation_incubation_days +
              weaning_days +
              temperature_k)

summary(model_car)
```

```{r}
ggplot(primates, aes(x = adult_weight_g, y = weaning_days)) +
  geom_point() +
  geom_smooth()
```


With the correlation so far above, it is quite interesting to find gestation incubation days and weaning day have a high effect on the lifespan in mammal. I will further dig to it

Aves: no weaning days record, metabolic rate is the only significant
Mammalia: 

Data cleaning: use clean data for lm, since it is comparing all factors but for data plotting it can be regular data

To do list:
gitignore comment
reseach q


Reference:

Lee, P. C. (1996) The meanings of weaning: Growth, lactation, and life history. Evolutionary anthropology. [Online] 5 (3), 87â€“98.


