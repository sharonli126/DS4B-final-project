---
title: "Final_report"
author: "Sharon"
date: "2023-09-29"
output: html_document
---
# Why do Some Animal have Longer Lifespan?

Why do some animals live only a few years, but some can live several years, or even over a hundred year? This has been one of the most interesting questions in Biology all the time. While animals varies in lifespan, the order of Mammalia, which we, humans belong to, particularly present a diverse of lifespan. For hamster or mouse, they only have around 4 years lifespan but for a gorilla, it can live up to around 60 years, or humans and whales can live even over 100 years old! Therefore, to understand deeper of how different factors correlate with lifespan in Mammalia, this study analyse a big database of aging and life history in over 4600 animal species from AnAge, aiming to find the correlation of possible aging related factors, including body weight, birth condition and metabolic rate.



Library
```{r, include=F}
library(tidyverse)
library(janitor)
library(skimr)
```

## Data Tidy

Loading the data
```{r}
raw_data <- read_delim("raw_data/anage_data.txt", 
                   delim = "\t", 
                   escape_double = FALSE, 
                   trim_ws = TRUE)

data <- raw_data |>
  clean_names()
```

Checking the data
```{r}
str(data)
```

```{r}
skim(data)
```


```{r}
mammalia <- data[data$class == "Mammalia",]
```

```{r}
mammalia_subset <- subset(mammalia, data_quality != "low" & sample_size != c("small", "tiny"))
```

```{r}
carnivora <- mammalia_subset[mammalia_subset$order == "Carnivora",]
primates <- mammalia_subset[mammalia_subset$order == "Primate",]
rodentia <- mammalia_subset[mammalia_subset$order == "Rodentia",]
artiodactyla <- mammalia_subset[mammalia_subset$order == "Artiodactyla",]
chiroptera <- mammalia_subset[mammalia_subset$order == "Chiroptera",]

selected_order <- rbind(carnivora, primates, rodentia, artiodactyla)
```


```{r}
weight <- mammalia_subset |>
  filter(!is.na(adult_weight_g) & !is.na(maximum_longevity_yrs))
```

```{r}
mammalia_subset|>
  group_by(order) |>
  summarise(n = n())|>
  arrange(desc(n))
```


## Correlation
```{r}
ggplot(selected_order, aes(x = maximum_longevity_yrs)) +
  geom_histogram() +
  facet_wrap(~ order) +
  coord_cartesian(xlim = c(1, 80))
```

```{r}
ggplot(selected_order, aes(x = adult_weight_g, y = maximum_longevity_yrs)) +
  geom_point() + 
  geom_smooth() +
  facet_wrap(~ order) + 
  labs(y = "Max. Lifespan") +
  coord_cartesian(xlim = c(1, 80000))
```

```{r}
ggplot(selected_order, aes(x = weaning_days, y = maximum_longevity_yrs)) +
  geom_point() + 
  geom_smooth() +
  labs(y = "Max. Lifespan") +
  facet_wrap(~ order)
```

 +
  coord_cartesian(xlim = c(1,10000))

```{r}
ggplot(selected_order, aes(x = gestation_incubation_days , y = maximum_longevity_yrs)) +
  geom_point() + 
  geom_smooth() +
  labs(y = "Max. Lifespan") +
  facet_wrap(~ order)
```

```{r}
ggplot(selected_order, aes(x = metabolic_rate_w , y = maximum_longevity_yrs)) +
  geom_point() + 
  geom_smooth() +
  labs(y = "Max. Lifespan")
```

Trying to fit a linear model
```{r}
model <- lm(data = mammalia_subset, 
            maximum_longevity_yrs ~ adult_weight_g + 
              metabolic_rate_w + 
              gestation_incubation_days +
              weaning_days)

summary(model)
```

```{r}
model_car <- lm(data = carnivora, 
            maximum_longevity_yrs ~ adult_weight_g + 
              metabolic_rate_w + 
              gestation_incubation_days +
              weaning_days)

summary(model_car)
```

With the correlation so far above, it is quite interesting to find gestation incubation days and weaning day have a high effect on the lifespan in mammal. I will further dig to it
