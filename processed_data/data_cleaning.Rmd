---
title: "data_cleaning"
author: "Sharon"
date: "2023-10-05"
output: html_document
---

Library
```{r}
library(tibble)
library(readr)
library(skimr)
library(dplyr)
library(janitor)
```

raw data
```{r}
raw_data <- read_delim("raw_data/anage_data.txt", delim = "\t", escape_double = FALSE, trim_ws = TRUE)

data <- clean_names(raw_data)
```


Filtering only the data I want to investigate and identify is there any weird data.
```{r}
mammalia <- data[data$class == "Mammalia",]

mammalia_subset <- mammalia[, c("hagrid", "kingdom", "phylum", "class", "order", "family", "genus", "species", "common_name", "female_maturity_days", "gestation_incubation_days", "weaning_days", "litter_clutch_size", "litters_clutches_per_year", "adult_weight_g", "maximum_longevity_yrs" )]

primates<- mammalia_subset[mammalia_subset$order == "Primates",]
rodentia <- mammalia_subset[mammalia_subset$order == "Rodentia",]
carnivora <- mammalia_subset[mammalia_subset$order == "Carnivora",]
artiodactyla <- mammalia_subset[mammalia_subset$order == "Artiodactyla",]

combined_order <- rbind(primates, rodentia, carnivora, artiodactyla)
```

Checking number of NA in the data
```{r}
skim(combined_order)
```


Here I try to remove nonsense data.

Assuming all species from same genus have a similar feature, so they wont have a vary difference. I am going to compare the difference between the maximum value and minimum value with the mean in each trait of genus have more than 1 row. For those with difference to mean over around a 1:3 ratio. I will find is there any paper/ website, supporting the varied value. If I the data I found was not similar to it, I will add it to the excluded data. 
```{r}
primates|>
group_by(genus) |>
  summarise(range_gid = max(gestation_incubation_days, na.rm = T) - min(gestation_incubation_days, na.rm = T), 
            mean_gid = mean (gestation_incubation_days, na.rm = T),
            range_wd = max(weaning_days, na.rm = T) - min(weaning_days, na.rm = T), 
            mean_wd = mean (weaning_days, na.rm = T),
            range_longevity = max(maximum_longevity_yrs, na.rm = T) - min(maximum_longevity_yrs, na.rm = T), 
            mean_longivity = mean (maximum_longevity_yrs, na.rm = T), 
            n = n()) |>
  filter(n > 1)
```

```{r}
primates|>
group_by(genus) |>
  summarise(range_clutch_size = max(litter_clutch_size, na.rm = T) - min(litter_clutch_size, na.rm = T), 
            mean_clutch_size = mean (litter_clutch_size, na.rm = T),
            range_number_clutch = max(litters_clutches_per_year, na.rm = T) - min(litters_clutches_per_year, na.rm = T), 
            mean_number_clutch = mean (litters_clutches_per_year, na.rm = T),
            range_weight = max(adult_weight_g, na.rm = T) - min(adult_weight_g, na.rm = T), 
            mean_weight = mean (adult_weight_g, na.rm = T), n = n()) |>
  filter(n > 1)
```

```{r}
rodentia|>
group_by(genus) |>
  summarise(range_gid = max(gestation_incubation_days, na.rm = T) - min(gestation_incubation_days, na.rm = T), 
            mean_gid = mean (gestation_incubation_days, na.rm = T),
            range_wd = max(weaning_days, na.rm = T) - min(weaning_days, na.rm = T), 
            mean_wd = mean (weaning_days, na.rm = T),
            range_longevity = max(maximum_longevity_yrs, na.rm = T) - min(maximum_longevity_yrs, na.rm = T), 
            mean_longivity = mean (maximum_longevity_yrs, na.rm = T), 
            n = n()) |>
  filter(n > 1)
```

```{r}
rodentia|>
group_by(genus) |>
  summarise(range_clutch_size = max(litter_clutch_size, na.rm = T) - min(litter_clutch_size, na.rm = T), 
            mean_clutch_size = mean (litter_clutch_size, na.rm = T),
            range_number_clutch = max(litters_clutches_per_year, na.rm = T) - min(litters_clutches_per_year, na.rm = T), 
            mean_number_clutch = mean (litters_clutches_per_year, na.rm = T),
            range_weight = max(adult_weight_g, na.rm = T) - min(adult_weight_g, na.rm = T), 
            mean_weight = mean (adult_weight_g, na.rm = T), n = n()) |>
  filter(n > 1)
```

```{r}
carnivora|>
group_by(genus) |>
  summarise(range_gid = max(gestation_incubation_days, na.rm = T) - min(gestation_incubation_days, na.rm = T), 
            mean_gid = mean (gestation_incubation_days, na.rm = T),
            range_wd = max(weaning_days, na.rm = T) - min(weaning_days, na.rm = T), 
            mean_wd = mean (weaning_days, na.rm = T),
            range_longevity = max(maximum_longevity_yrs, na.rm = T) - min(maximum_longevity_yrs, na.rm = T), 
            mean_longivity = mean (maximum_longevity_yrs, na.rm = T), 
            n = n()) |>
  filter(n > 1)
```

```{r}
carnivora|>
group_by(genus) |>
  summarise(range_clutch_size = max(litter_clutch_size, na.rm = T) - min(litter_clutch_size, na.rm = T), 
            mean_clutch_size = mean (litter_clutch_size, na.rm = T),
            range_number_clutch = max(litters_clutches_per_year, na.rm = T) - min(litters_clutches_per_year, na.rm = T), 
            mean_number_clutch = mean (litters_clutches_per_year, na.rm = T),
            range_weight = max(adult_weight_g, na.rm = T) - min(adult_weight_g, na.rm = T), 
            mean_weight = mean (adult_weight_g, na.rm = T), n = n()) |>
  filter(n > 1)
```

```{r}
artiodactyla|>
group_by(genus) |>
  summarise(range_gid = max(gestation_incubation_days, na.rm = T) - min(gestation_incubation_days, na.rm = T), 
            mean_gid = mean (gestation_incubation_days, na.rm = T),
            range_wd = max(weaning_days, na.rm = T) - min(weaning_days, na.rm = T), 
            mean_wd = mean (weaning_days, na.rm = T),
            range_longevity = max(maximum_longevity_yrs, na.rm = T) - min(maximum_longevity_yrs, na.rm = T), 
            mean_longivity = mean (maximum_longevity_yrs, na.rm = T), 
            n = n()) |>
  filter(n > 1)
```

```{r}
artiodactyla|>
group_by(genus) |>
  summarise(range_clutch_size = max(litter_clutch_size, na.rm = T) - min(litter_clutch_size, na.rm = T), 
            mean_clutch_size = mean (litter_clutch_size, na.rm = T),
            range_number_clutch = max(litters_clutches_per_year, na.rm = T) - min(litters_clutches_per_year, na.rm = T), 
            mean_number_clutch = mean (litters_clutches_per_year, na.rm = T),
            range_weight = max(adult_weight_g, na.rm = T) - min(adult_weight_g, na.rm = T), 
            mean_weight = mean (adult_weight_g, na.rm = T), n = n()) |>
  filter(n > 1)
```






